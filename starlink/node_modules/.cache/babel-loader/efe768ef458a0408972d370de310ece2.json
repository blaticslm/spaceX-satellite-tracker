{"ast":null,"code":"var _jsxFileName = \"K:\\\\Laioffer\\\\FullStack\\\\SpaceX\\u9879\\u76EE\\\\starlink\\\\src\\\\components\\\\WorldMap.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { WORLD_MAP_URL } from \"../constants\";\nimport { feature } from \"topojson-client\";\nimport { geoKavrayskiy7 } from \"d3-geo-projection\";\nimport { geoGraticule, geoPath } from \"d3-geo\";\nimport { select as d3select } from \"d3-selection\";\nimport projection from \"d3-geo/src/projection\"; // 改select名字\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst width = 960;\nconst height = 600;\n\nclass WorldMap extends Component {\n  constructor() {\n    super(); //create a map ref\n\n    this.generateMap = land => {\n      const geo_projection = geoKavrayskiy7(); //返回的是个method,然后定义projection的参数\n\n      geo_projection.scale(170).translate(width / 2, height / 2).precision(0.1);\n      const graticule = geoGraticule(); //经纬度\n      //get map canvas\n      //this.refmap has --> {current:canvas}\n\n      const canvas = d3select(this.refmap.current) //获得地图canvas\n      .attr(\"width\", width).attr(\"height\", height); //now,canvas有projection有，那么开始把数据注入\n      //画图前初始化\n\n      let context = canvas.node().getContext(\"2d\"); //canvas的形式\n\n      let path = geoPath().projection(geo_projection).context(context); //画图\n\n      land.forEach(ele => {\n        context.fillStyle = \"B3DDEF\"; //填充颜色\n\n        context.strokeStyle = \"#000\"; //边界颜色\n\n        context.globalAlpha = 0.7; //地图深浅\n\n        context.beginPath();\n        path(ele);\n        context.fill();\n        context.stroke();\n      });\n    };\n\n    this.refmap = /*#__PURE__*/React.createRef(); //refmap is in WorldMap.js, 初始化\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"map-box\",\n      children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n        className: \"map\",\n        ref: this.refmap\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 13\n    }, this);\n  }\n\n  componentDidMount() {\n    //获取数据时用这个\n    axios.get(WORLD_MAP_URL).then(res => {\n      //console.log(res)\n      if (res.status === 200) {\n        const {\n          data\n        } = res; //feature(data,data.object.countries).features\n        //feature(data,data.object.countries)这个部分res的country的部分给拿到手了。接着country这个feature下还有features，这才是我们想要的\n        //step 1: convert map data to geojson\n\n        const land = feature(data, data.objects.countries).features; //step 2: generate map\n        //geoJson --> projection parameter preparation ---> projected white board --> using D3\n\n        this.generateMap(land);\n      }\n    }).catch(err => {\n      console.log(\"error on fetch map data: \", err);\n    });\n  }\n\n}\n\nexport default WorldMap;","map":{"version":3,"sources":["K:/Laioffer/FullStack/SpaceX项目/starlink/src/components/WorldMap.js"],"names":["React","Component","axios","WORLD_MAP_URL","feature","geoKavrayskiy7","geoGraticule","geoPath","select","d3select","projection","width","height","WorldMap","constructor","generateMap","land","geo_projection","scale","translate","precision","graticule","canvas","refmap","current","attr","context","node","getContext","path","forEach","ele","fillStyle","strokeStyle","globalAlpha","beginPath","fill","stroke","createRef","render","componentDidMount","get","then","res","status","data","objects","countries","features","catch","err","console","log"],"mappings":";AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAAQC,aAAR,QAA4B,cAA5B;AACA,SAAQC,OAAR,QAAsB,iBAAtB;AACA,SAAQC,cAAR,QAA6B,mBAA7B;AACA,SAAQC,YAAR,EAAsBC,OAAtB,QAAoC,QAApC;AACA,SAAQC,MAAM,IAAIC,QAAlB,QAAiC,cAAjC;AACA,OAAOC,UAAP,MAAuB,uBAAvB,C,CAAgD;;;AAEhD,MAAMC,KAAK,GAAG,GAAd;AACA,MAAMC,MAAM,GAAG,GAAf;;AACA,MAAMC,QAAN,SAAuBZ,SAAvB,CAAiC;AAC7Ba,EAAAA,WAAW,GAAG;AACV,YADU,CAEV;;AAFU,SAoCdC,WApCc,GAoCAC,IAAI,IAAI;AAClB,YAAMC,cAAc,GAAGZ,cAAc,EAArC,CADkB,CACuB;;AACzCY,MAAAA,cAAc,CACTC,KADL,CACW,GADX,EAEKC,SAFL,CAEeR,KAAK,GAAG,CAFvB,EAE0BC,MAAM,GAAG,CAFnC,EAGKQ,SAHL,CAGe,GAHf;AAKA,YAAMC,SAAS,GAAGf,YAAY,EAA9B,CAPkB,CAOgB;AAElC;AACA;;AACA,YAAMgB,MAAM,GAAGb,QAAQ,CAAC,KAAKc,MAAL,CAAYC,OAAb,CAAR,CAA8B;AAA9B,OACVC,IADU,CACL,OADK,EACId,KADJ,EAEVc,IAFU,CAEL,QAFK,EAEKb,MAFL,CAAf,CAXkB,CAgBlB;AACA;;AACA,UAAIc,OAAO,GAAGJ,MAAM,CAACK,IAAP,GAAcC,UAAd,CAAyB,IAAzB,CAAd,CAlBkB,CAkB4B;;AAC9C,UAAIC,IAAI,GAAGtB,OAAO,GACbG,UADM,CACKO,cADL,EAENS,OAFM,CAEEA,OAFF,CAAX,CAnBkB,CAuBlB;;AACAV,MAAAA,IAAI,CAACc,OAAL,CAAaC,GAAG,IAAI;AAChBL,QAAAA,OAAO,CAACM,SAAR,GAAoB,QAApB,CADgB,CACc;;AAC9BN,QAAAA,OAAO,CAACO,WAAR,GAAsB,MAAtB,CAFgB,CAEc;;AAC9BP,QAAAA,OAAO,CAACQ,WAAR,GAAsB,GAAtB,CAHgB,CAGW;;AAE3BR,QAAAA,OAAO,CAACS,SAAR;AACAN,QAAAA,IAAI,CAACE,GAAD,CAAJ;AACAL,QAAAA,OAAO,CAACU,IAAR;AACAV,QAAAA,OAAO,CAACW,MAAR;AAEH,OAVD;AAWH,KAvEa;;AAGV,SAAKd,MAAL,gBAAcvB,KAAK,CAACsC,SAAN,EAAd,CAHU,CAGuB;AACpC;;AACDC,EAAAA,MAAM,GAAG;AACL,wBACI;AAAK,MAAA,SAAS,EAAC,SAAf;AAAA,6BACI;AAAQ,QAAA,SAAS,EAAC,KAAlB;AAAwB,QAAA,GAAG,EAAE,KAAKhB;AAAlC;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YADJ;AAKH;;AAEDiB,EAAAA,iBAAiB,GAAG;AAAE;AAClBtC,IAAAA,KAAK,CAACuC,GAAN,CAAUtC,aAAV,EACKuC,IADL,CACUC,GAAG,IAAI;AACT;AACA,UAAIA,GAAG,CAACC,MAAJ,KAAe,GAAnB,EAAwB;AACpB,cAAK;AAACC,UAAAA;AAAD,YAASF,GAAd,CADoB,CAEpB;AACA;AAEA;;AACA,cAAM3B,IAAI,GAAGZ,OAAO,CAACyC,IAAD,EAAMA,IAAI,CAACC,OAAL,CAAaC,SAAnB,CAAP,CAAqCC,QAAlD,CANoB,CAQpB;AACA;;AACA,aAAKjC,WAAL,CAAiBC,IAAjB;AAEH;AACJ,KAhBL,EAiBKiC,KAjBL,CAiBWC,GAAG,IAAI;AACVC,MAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCF,GAAzC;AACH,KAnBL;AAoBH;;AAnC4B;;AA2EjC,eAAerC,QAAf","sourcesContent":["import React, {Component} from 'react';\r\nimport axios from 'axios'\r\nimport {WORLD_MAP_URL} from \"../constants\";\r\nimport {feature} from \"topojson-client\"\r\nimport {geoKavrayskiy7} from \"d3-geo-projection\";\r\nimport {geoGraticule, geoPath} from \"d3-geo\";\r\nimport {select as d3select} from \"d3-selection\";\r\nimport projection from \"d3-geo/src/projection\"; // 改select名字\r\n\r\nconst width = 960;\r\nconst height = 600;\r\nclass WorldMap extends Component {\r\n    constructor() {\r\n        super();\r\n        //create a map ref\r\n        this.refmap = React.createRef(); //refmap is in WorldMap.js, 初始化\r\n    }\r\n    render() {\r\n        return (\r\n            <div className=\"map-box\">\r\n                <canvas className=\"map\" ref={this.refmap}/>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    componentDidMount() { //获取数据时用这个\r\n        axios.get(WORLD_MAP_URL)\r\n            .then(res => {\r\n                //console.log(res)\r\n                if (res.status === 200) {\r\n                    const{data} = res;\r\n                    //feature(data,data.object.countries).features\r\n                    //feature(data,data.object.countries)这个部分res的country的部分给拿到手了。接着country这个feature下还有features，这才是我们想要的\r\n\r\n                    //step 1: convert map data to geojson\r\n                    const land = feature(data,data.objects.countries).features\r\n\r\n                    //step 2: generate map\r\n                    //geoJson --> projection parameter preparation ---> projected white board --> using D3\r\n                    this.generateMap(land)\r\n\r\n                }\r\n            })\r\n            .catch(err => {\r\n                console.log(\"error on fetch map data: \", err)\r\n            })\r\n    }\r\n\r\n    generateMap = land => {\r\n        const geo_projection = geoKavrayskiy7(); //返回的是个method,然后定义projection的参数\r\n        geo_projection\r\n            .scale(170)\r\n            .translate(width / 2, height / 2)\r\n            .precision(0.1)\r\n\r\n        const graticule = geoGraticule(); //经纬度\r\n\r\n        //get map canvas\r\n        //this.refmap has --> {current:canvas}\r\n        const canvas = d3select(this.refmap.current) //获得地图canvas\r\n            .attr(\"width\", width)\r\n            .attr(\"height\", height)\r\n\r\n\r\n        //now,canvas有projection有，那么开始把数据注入\r\n        //画图前初始化\r\n        let context = canvas.node().getContext(\"2d\"); //canvas的形式\r\n        let path = geoPath()\r\n            .projection(geo_projection)\r\n            .context(context)\r\n\r\n        //画图\r\n        land.forEach(ele => {\r\n            context.fillStyle = \"B3DDEF\"; //填充颜色\r\n            context.strokeStyle = \"#000\"; //边界颜色\r\n            context.globalAlpha = 0.7; //地图深浅\r\n\r\n            context.beginPath();\r\n            path(ele);\r\n            context.fill();\r\n            context.stroke();\r\n\r\n        })\r\n    }\r\n}\r\n\r\nexport default WorldMap;"]},"metadata":{},"sourceType":"module"}